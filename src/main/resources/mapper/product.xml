<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.example.demo.repository.ProductMapper" >
	<select id="countSearch" resultType="int">
	   	SELECT 
	   		COUNT(*)
	    FROM
	    	products
	    <where>
	    	1 = 1
	        <if test="productCode != null">
	            AND product_code LIKE CONCAT(#{productCode}, '%')
	        </if>
	        <if test="productName != null">
	            AND product_name LIKE CONCAT(#{productName}, '%')
	        </if>
	    </where>
	</select>
	
	<select id="search" resultType="java.util.Map">
	    SELECT 
	    	product_id, product_code, product_name, purchase_price, sale_price, inventory_quantity
	    FROM
	    	products
	    <where>
	    	1 = 1
	        <if test="productCode != null">
	            AND product_code LIKE CONCAT(#{productCode}, '%')
	        </if>
	        <if test="productName != null">
	            AND product_name LIKE CONCAT(#{productName}, '%')
	        </if>
	    </where>
	    LIMIT 3
	    OFFSET #{offset}
	</select>
  </mapper>